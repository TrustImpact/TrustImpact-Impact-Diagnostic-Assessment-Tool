<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
<title>Impact Diagnosis Assessment Tool</title>
<link href="https://trst.uk/css/app.css" rel="stylesheet">
<script src="https://kit.fontawesome.com/19a0336ebe.js" crossorigin="anonymous"></script>
<style>
    body {
        font-family: 'Raleway', sans-serif;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        background-color: #ffffff;
    }
    #header {
        width: 100%;
        background-color: #FFFFFF; /* Adjust the background color as needed */
        padding: 10px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* Optional: adds a shadow for depth */
        text-align: center; /* Centers the logo horizontally */
    }
    #header img {
        height: 100px; 
    }
    div#form-container {
        background-color: #ffffff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
        border: 5px solid #f7d32e;
        max-width: 1400px;
        width: 100%;
        margin: auto;
    }
    h1, h2, h3, h4, p {
        color: #000000;
    }
    h4 {
        font-weight: normal;
    }
    p {
        font-size: 60%;
    }
    select, button {
        padding: 10px;
        border-radius: 4px;
        border: 1px solid #ddd;
        margin-top: 10px;
    }
    button {
        background-color: #5D3FD3;
        color: #fff;
        border: none;
        cursor: pointer;
        font-weight: bold;
    }
    button:hover {
        background-color: #4c32cc;
    }
    #downloadResultsButton {
        display: none;
    }
    .containers-row {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-around;
        align-items: flex-start;
        width: 100%;
    }
    .container {
        flex: 0 0 30%;
        margin: 10px;
    }
    .output-score {
        display: none;
    }
    .container-score {
        margin-top: 10px;
        padding: 10px;
        background-color: #e9e9e9;
        border-radius: 4px;
        font-weight: bold;
    }
    select {
        width: 100%;
        height: 40px;
        padding: 5px 10px;
        font-size: 16px;
        border: 1px solid #ddd;
        border-radius: 4px;
        box-sizing: border-box;
        margin-top: 10px;
        background-color: white;
        cursor: pointer;
    }
    select:hover {
        border-color: #aaa;
    }
    select:focus {
        outline: none;
        border-color: #5D3FD3;
    }
    .chart-container {
        display: flex;
        align-items: center;
    }
    #legend-container {
        margin-left: 20px;
    }
    .custom-legend ul {
        list-style-type: none;
        padding-left: 0;
        margin-left: 0;
    }
    .custom-legend {
        text-align: left;
    }
</style>
</head>

<body>

<div id="header">
    <img src="https://www.trustimpact.com/wp-content/uploads/2020/09/trust-impact-logo.png" alt="Trust Impact Logo" style="height: 100px;">
</div>

<div id="form-container">
    <h1>Details</h1>
    <div class="question">
        <label for="organisationName">Organisation Name:</label>
        <input type="text" id="organisationName" name="organisationName" placeholder="Enter organisation name" required>
    </div>
    <div class="question">
        <label for="LeadImpactConsultant">Lead Impact Consultant:</label>
        <input type="text" id="LeadImpactConsultant" name="LeadImpactConsultant" placeholder="Enter LIC name" required>
    </div>
    <div class="question">
        <label for="ResearcherConsultant">Research Consultant:</label>
        <input type="text" id="ResearchConsultant" name="ResearchConsultant" placeholder="Enter Research Consultant name" required>
    </div>
    <div class="question">
        <label for="DataConsultant">Data Consultant:</label>
        <input type="text" id="DataConsultant" name="DataConsultant" placeholder="Enter Data Consultant name" required>
    </div>

<!--<div class="containers-row"> -->
<!-- Purpose Alignment Tool Score Container -->
<div id="PurposeAlignmentToolScore" class="container">
    <h1>Purpose Alignment Tool Score</h1>
    <h4>1) What was your team's alignment to purpose score?</h4>
    <p>(Please use the overall alignment score)</p>
    <br>

    <select id="alignmentScoreSelect" onchange="calculateScore('alignmentScoreSelect', 'outputPurposeAlignmentScore')">
        <option value="N/A">Please Select</option>
        <option value="0">0</option>
        <option value="1">1-10</option>
        <option value="2">11-20</option>
        <option value="3">21-30</option>
        <option value="4">31-40</option>
        <option value="5">41-50</option>
        <option value="6">51-60</option>
        <option value="7">61-70</option>
        <option value="8">71-80</option>
        <option value="9">81-90</option>
        <option value="10">91-100</option>
    </select>
    <div class="output-score">
        Purpose Alignment Score: <span id="outputPurposeAlignmentScore">0</span>
    </div>
</div>

<div class="containers-row">
<!-- Purpose Statement Assessment Container -->
<div id="PurposeStatementAssessmentScore" class="container">
    <h1>Purpose Statement Assessment</h1>
    
    <div class="question">
        <h4>2a) To what extent is your purpose statement succinct?</h4>
        <p>(by succinct we anticipate this to be under 10 words and to the point)</p>
        <br>
        <select id="lengthScoreSelect" onchange="calculateScore('lengthScoreSelect', 'outputLengthScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Length Score: <span id="outputLengthScore">0</span>
        </div>
    </div>

    <div class="question">
        <h4>2.b) How prevalent are common words such as support in your purpose statement?</h4>
        <p>(Please note this scale has been inverted for assessment purposes)</p>
        <br>
        <select id="commonwordsselect" onchange="calculateScore('commonwordsselect', 'outputcommonwordScore')">
            <option value="N/A">Please Select</option>
            <option value="10">0 - Not at all</option>
            <option value="9">1</option>
            <option value="8">2</option>
            <option value="7">3</option>
            <option value="6">4</option>
            <option value="5">5</option>
            <option value="4">6</option>
            <option value="3">7</option>
            <option value="2">8</option>
            <option value="1">9</option>
            <option value="0">10 - Extremely Prevalent</option>
        </select>
        <div class="output-score">
            Common words Score: <span id="outputcommonwordScore">0</span> <!-- Default score -->
        </div>
    </div>


    <div class="question">
        <h4>2.c) To what extent do you feel your purpose statement is unique to your organisation?</h4>
        <br>
        <select id="uniqueselect" onchange="calculateScore('uniqueselect', 'outputuniqueScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Uniqueness Score: <span id="outputuniqueScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>2d) On a scale of 0 - 10, how clear is your purpose statement?</h4>
        <p>(i.e. free from jargon and easy to understand)</p>
        <br>
        <select id="jargonselect" onchange="calculateScore('jargonselect', 'outputjargonScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Clarity Score: <span id="outputjargonScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>2e) On a scale of 0 - 10, how focussed is your purpose statement?</h4>
        <p>(i.e. does it explicitly capture what you are trying to achieve as an organisation and the method for achieving this)</p>
        <br>
        <select id="focusselect" onchange="calculateScore('focusselect', 'outputfocusScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Focus Score: <span id="outputfocusScore">0</span> <!-- Default score -->
        </div>
    </div>
</div>

<!-- Impact Leadership Container -->
    <div id="ImpactLeadershipScore" class="container">
        <h1>Impact Leadership Assessment</h1>
    
    <div class="question">
        <h4>3a) On a scale of 0 - 10, to what extent would you agree that impact is led from the top of your organisation?</h4>
        <p>(i.e. do your senior leaders regularly discuss impact and take action to improve it? Are your board and senior team aligned?)</p>
        <select id="impactledselect" onchange="calculateScore('impactledselect', 'outputledScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Impact Led Score: <span id="outputledScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">   
        <h4>3b) To what extent do you agree that people in your organisation are excited about delivering social impact?</h4>
        <br>
        <select id="appetiteselect" onchange="calculateScore('appetiteselect', 'outputappetiteScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Impact appetite Score: <span id="outputappetiteScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>3c) To what extent would you agree work around understanding and measuring impact has been successfully undertaken in the organisation?</h4>
        <p>(i.e. has any historical work undertaken been successful?)</p>
        <br>
        <select id="desireselect" onchange="calculateScore('desireselect', 'outputdesireScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Impact desire Score: <span id="outputdesireScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>3d) To what extent do you feel the organisation is willing to undertake further work around understanding and measuring impact?</h4>
        <br>
        <select id="cultureselect" onchange="calculateScore('cultureselect', 'outputcultureScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Impact culture Score: <span id="outputcultureScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>3e) To what extent would you agree that your organisation currently has a culture of understanding and measuring impact?</h4>
        <br>
        <select id="blockersselect" onchange="calculateScore('blockersselect', 'outputblockerscore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Impact blocker Score: <span id="outputblockerscore">0</span> <!-- Default score -->
        </div>
    </div>


    <div class="question">
        <h4>3f) How easy would it be to achieve buy-in from key people in your organisation to develop impact practices and measure them?</h4>
        <br>
        <select id="buyinselect" onchange="calculateScore('buyinselect', 'outputbuyinScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Buy-in Score: <span id="outputbuyinScore">0</span> <!-- Default score -->
        </div>
    </div>
</div>


<!--<div class="containers-row"> -->
    <!-- Theory of Change Container -->
    <div id="ToCScore" class="container">
        <h1>Theory of Change Assessment</h1>

    <div class="question">
        <h4>4a) On a scale of 0 - 10 how complete do you believe your theory of change is?</h4>
        <p>(Does it include your resources, activities, outputs, outcomes, and impact?)</p>
        
        <select id="TOCselect" onchange="calculateScore('TOCselect', 'outputTOCScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - We do not have a theory of change</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            ToC Score: <span id="outputTOCScore">0</span> <!-- Default score -->
        </div>
        <p>If no theory of change exists please disregard the rest of this section</p>
    </div>

    <div class="question">
        <h4>4b) To what extent is your theory of change used to drive the work of your organisation?</h4>
        <br>
        <select id="orgdriveselect" onchange="calculateScore('orgdriveselect', 'outputorgdriveScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            ToC use Score: <span id="outputorgdriveScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>4c) To what extent do you think your organisation would be willing to revisit your theory of change?</h4>
        <br>
        <select id="upforchangeselect" onchange="calculateScore('upforchangeselect', 'outputupforchangeScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Ameniability Score: <span id="outputupforchangeScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>4d) To what extent do you agree that your theory of change is simple and straight forward?</h4>
        <p>Is it easily understood, non-confusing, one one page?</p>
        <select id="complexselect" onchange="calculateScore('complexselect', 'outputcomplexScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            ToC Complexity Score: <span id="outputcomplexScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>4e) To what extent would you agree that the measures in your theory of change are measures of impact and not measures of reach?</h4>
        <br>
        <select id="correctlydefinedselect" onchange="calculateScore('correctlydefinedselect', 'outputcorrectlydefinedscore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Definitions Score: <span id="outputcorrectlydefinedscore">0</span> <!-- Default score -->
        </div>
    </div>
</div>


<!--<div class="containers-row"> -->
    <!-- MWM Container -->
    <div id="MWMScore" class="container">
        <h1>Measurement Framework Assessment</h1>
    <div class="question">  
        <h4>5a) On a scale of 0-10, Is your framework feasable, cost effective, time efficient, resource appropriate and producing good quality, and reliable data?</h4>
        <br>
        <select id="MWMfeasibilityselect" onchange="calculateScore('MWMfeasibilityselect', 'outputMWMfeasibleScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            MWM feasibility Score: <span id="outputMWMfeasibleScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>5b) To what extend do you feel you are measuring too many things?</h4>
        <br>
        <select id="numberofindicatorsselect" onchange="calculateScore('numberofindicatorsselect', 'outputnumberofindicatorsScore')">
            <option value="N/A">Please Select</option>
            <option value="10">0 - Not at all</option>
            <option value="9">1</option>
            <option value="8">2</option>
            <option value="7">3</option>
            <option value="6">4</option>
            <option value="5">5</option>
            <option value="4">6</option>
            <option value="3">7</option>
            <option value="2">8</option>
            <option value="1">9</option>
            <option value="0">10 - Extremely</option>
        </select>
        <div class="output-score">
            MWM count of indicators Score: <span id="outputnumberofindicatorsScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>5c) To what extent do you feel that you are collecting only output rather than outcome measures?</h4>
        <br>
        <select id="percentageofindicatorsselect" onchange="calculateScore('percentageofindicatorsselect', 'outputpercentageofindicatorsScore')">
            <option value="N/A">Please Select</option>
            <option value="10">0 - Not at all</option>
            <option value="9">1</option>
            <option value="8">2</option>
            <option value="7">3</option>
            <option value="6">4</option>
            <option value="5">5</option>
            <option value="4">6</option>
            <option value="3">7</option>
            <option value="2">8</option>
            <option value="1">9</option>
            <option value="0">10 - Extremely</option>
        </select>
        <div class="output-score">
            MWM percentage of indicators Score: <span id="outputpercentageofindicatorsScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>5d) To what extent do you believe your outcomes measures are based on validated scales?</h4>
        <br>
        <select id="validatedindicatorsselect" onchange="calculateScore('validatedindicatorsselect', 'outputvalidatedindicatorsScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            MWM Validated indicators Score: <span id="outputvalidatedindicatorsScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>5e) To what extent do you feel you can compare your organisations impact to others?</h4>
        <select id="externalddataselect" onchange="calculateScore('externalddataselect', 'outputexternaldataScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            MWM indicators comparison Score: <span id="outputexternaldataScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>5f) To what extent are you able to use demographic measures to assess your reaching your target population?</h4>
        <select id="reachdataselect" onchange="calculateScore('reachdataselect', 'outputreachdataScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            MWM demographics Score: <span id="outputreachdataScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>5g) To what extent are you using factors to interogate your outcome measures by characteristic?</h4>
        <br>
        <select id="segmentselect" onchange="calculateScore('segmentselect', 'outputsegmentScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            MWM Segmentation Score: <span id="outputsegmentScore">0</span> <!-- Default score -->
        </div>
    </div>
</div>

<!--<div class="containers-row"> -->
    <!-- Data Container -->
    <div id="DataScore" class="container">
        <h1>Data Assessment</h1>
    <div class="question">
        <h4>6a) To what extent do you use defined and structured data fields rather than free text?</h4>
        <br>
        <select id="Datastructureselect" onchange="calculateScore('Datastructureselect', 'outputDataStructureScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Data Structure Score: <span id="outputDataStructureScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>6b) To what extent are you able to use your data and systems to track participants over time?</h4>
        <p>(do you utilse consistent unique identifiers throughout your data and systems?)</p>
        <select id="Datauniquedataselect" onchange="calculateScore('Datauniquedataselect', 'outputuniquedataScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Data Uniqueness Score: <span id="outputuniquedataScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>6c) To what extent would you describe your staff as 'data savy'?</h4>
        <br>
        <select id="Dataexpertiseselect" onchange="calculateScore('Dataexpertiseselect', 'outputexpertiseScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Data Savvy Score: <span id="outputexpertiseScore">0</span> <!-- Default score -->
        </div>
    </div>


    <div class="question">
        <h4>6d) How confident are you that you have complete and useful datasets collected from beneficairies? </h4>
        <br>
        <select id="Datacompletenessselect" onchange="calculateScore('Datacompletenessselect', 'outputcompletenessScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Data Completeness Score: <span id="outputcompletenessScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>6e) To what extent is your data quality checked and maintained regularly?</h4>
        <p>(Is your data clearly timestamped, the quality checked and updated regularly?)</p>
        <select id="Datatimestampselect" onchange="calculateScore('Datatimestampselect', 'outputtimestampScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Data timepoints Score: <span id="outputtimestampScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>6f) Is data structure and format consistent over time?</h4>
        <br>
        <select id="Dataconsistencyselect" onchange="calculateScore('Dataconsistencyselect', 'outputconsistencyScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Data consistency Score: <span id="outputconsistencyScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>6g) To what extent do you believe your data is being effectively collected and reported on?</h4>
        <br>
        <select id="Dataeffectivenessselect" onchange="calculateScore('Dataeffectivenessselect', 'outputeffectivenessScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Data effectiveness Score: <span id="outputeffectivenessScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>6h) To what extent is your data capture automated and free from manual processes?</h4>
        <br>
        <select id="Dataautomaticityselect" onchange="calculateScore('Dataautomaticityselect', 'outputautomaticityScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Data automaticity Score: <span id="outputautomaticityScore">0</span> <!-- Default score -->
        </div>
    </div>
</div>


<!--<div class="containers-row"> -->
    <!-- System Container -->
    <div id="SystemScore" class="container">
        <h1>System Assessment</h1>
    <div class="question">
        <h4>7a) Is the number of systems being operated appropriate for the organisation?</h4>
        <br>
        <select id="numberofsystemsselect" onchange="calculateScore('numberofsystemsselect', 'outputnumberofsystemsScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            System appropriateness Score: <span id="outputnumberofsystemsScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>7b) Are the systems modern and fit for purpose?</h4>
        <br>
        <select id="systemfitnessselect" onchange="calculateScore('systemfitnessselect', 'outputsystemfitnessScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            System fitness Score: <span id="outputsystemfitnessScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>7c) Does the organisation have the appropriate personnel and support in place to run their systems?</h4>
        <br>
        <br>
        <select id="systempersonnelselect" onchange="calculateScore('systempersonnelselect', 'outputsystempersonnelScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            System Personnel Score: <span id="outputsystempersonnelScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>7d) Is it possible for the client to customise impact relevant systems without external support services?</h4>
        <br>
        <select id="systempcustomisationselect" onchange="calculateScore('systempcustomisationselect', 'outputsystemcustomisationScore')">
            <option value="N/A">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            System Customisation Score: <span id="outputsystemcustomisationScore">0</span> <!-- Default score -->
        </div>
    </div>

    <div class="question">
        <h4>7e) If applicable, Are your systems able interact with each other?</h4>
        <select id="systemconnectivityselect" onchange="calculateScore('systemconnectivityselect', 'outputsystemconnectivityScore')">
            <option value="N/A">Please Select</option>
            <option value="N/A">N/A</option>     
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Seamlessly</option>
        </select>
        <div class="output-score">
            System Connectivity Score: <span id="outputsystemconnectivityScore">0</span> <!-- Default score -->
        </div>
    </div> 
</div>
</div>
    
    <!-- Score Summary Table -->
    <div id="scoreSummary">
        <h1>Score Summary</h1>
        <table class="table table-bordered table-striped">
            <thead>
                <tr>
                    <th>Section</th>
                    <th>Average Score</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Purpose Alignment Score</td>
                    <td id="totalPurposeAlignmentToolScore">0</td>
                </tr>
                <tr>
                    <td>Purpose Statement Score</td>
                    <td id="totalPurposeStatementAssessmentScore">0</td>
                </tr>
                <tr>
                    <td>Impact Leadership Score</td>
                    <td id="totalImpactLeadershipScore">0</td>
                </tr>
                <tr>
                    <td>Theory of Change Score</td>
                    <td id="totalToCScore">0</td>
                </tr>
                <tr>
                    <td>Measurement Framework Score</td>
                    <td id="totalMWMScore">0</td>
                </tr>
                <tr>
                    <td>Data Review Score</td>
                    <td id="totalDataScore">0</td>
                </tr>
                <tr>
                    <td>System Review Score</td>
                    <td id="totalSystemScore">0</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div id="overallAverageScoreDisplay">
        <h2>Overall Average Score: <span id="displayAverageScore">0</span></h2>
    </div>

    <button onclick="generatePolarChart()">Generate Polar Chart</button>
    <button id="downloadResultsButton" onclick="downloadResultsWithCalculatedTable()">Download Complete Results</button>
</div>

<!-- Radar Chart Container -->
<div class="chart-container">
    <canvas id="myPolarChart" width="800" height="800"></canvas>
    <div id="legend-container"></div>
</div>

<script>
function collectDataForAnalysis() {
    let data = [];
    document.querySelectorAll('.container select').forEach(function(select) {
        let questionText = select.closest('div.question, div').querySelector('h4, p').textContent.trim();
        let selectedOptionText = select.options[select.selectedIndex].text;
        if (selectedOptionText === "N/A") return;
        data.push({ question: questionText, response: selectedOptionText });
    });
}

function initializeScoreTable() {
    document.querySelectorAll('#scoreSummary tbody tr').forEach(function(row) {
        row.style.display = 'none';
    });
}

initializeScoreTable();

function calculateScore(selectId, outputId) {
    var selectElement = document.getElementById(selectId);
    var score = parseInt(selectElement.value, 10);
    document.getElementById(outputId).textContent = score;
    updateScoreTable(selectElement.closest('.container').id);
}

function updateOverallAverageScore() {
    let totalScore = 0;
    let numberOfScores = 0;
    document.querySelectorAll('#scoreSummary tbody tr').forEach(row => {
        if (row.style.display !== 'none') {
            let score = parseFloat(row.cells[1].textContent);
            if (!isNaN(score)) {
                totalScore += score;
                numberOfScores++;
            }
        }
    });
    let averageScore = numberOfScores > 0 ? (totalScore / numberOfScores).toFixed(2) : 0;
    document.getElementById('displayAverageScore').textContent = averageScore;
}

function updateScoreTable(containerId) {
    var container = document.getElementById(containerId);
    var selects = container.querySelectorAll('select');
    var totalScore = 0;
    var scoredSelects = 0;
    selects.forEach(function(select) {
        if (select.value !== "N/A") {
            totalScore += parseInt(select.value, 10);
            scoredSelects++;
        }
    });
    var averageScore = scoredSelects > 0 ? (totalScore / scoredSelects).toFixed(2) : 0;
    var scoreCellId = 'total' + containerId;
    var scoreCell = document.getElementById(scoreCellId);
    if (scoreCell) {
        scoreCell.textContent = averageScore;
        scoreCell.closest('tr').style.display = scoredSelects > 0 ? '' : 'none';
    }
    updateOverallAverageScore();
}

function generatePolarChart() {
    var ctx = document.getElementById('myPolarChart').getContext('2d');
    if (window.myPolarChart && typeof window.myPolarChart.destroy === 'function') {
        window.myPolarChart.destroy();
    }
    var { labels, averageScores } = getAverageScoresAndLabels();
    const backgroundColors = averageScores.map(score => determineBackgroundColor(score));
    window.myPolarChart = new Chart(ctx, {
        type: 'polarArea',
        data: {
            labels: labels,
            datasets: [{
                label: 'Average Scores',
                data: averageScores,
                backgroundColor: backgroundColors,
                borderColor: '#fff',
                hoverBackgroundColor: 'rgba(255, 99, 132, 0.8)',
                hoverBorderColor: '#fff'
            }]
        },
        options: {
            scales: {
                r: {
                    beginAtZero: true,
                    max: 10,
                    ticks: {
                        color: "#000000",
                        font: {
                            size: 14
                        }
                    },
                    pointLabels: {
                        color: "#000000",
                        font: {
                            size: 18
                        }
                    }
                }
            },
            plugins: {
                legend: {
                    display: false,
                },
                title: {
                    display: true,
                    text: 'Impact Diagnostic Assessment',
                    color: "#000000",
                    font: {
                        size: 20
                    }
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            let label = context.label || '';
                            let value = context.raw || 0;
                            return `${label}: ${value}`;
                        }
                    }
                },
                datalabels: {
                    display: true,
                    color: 'black',
                    formatter: function(value, context) {
                        return context.chart.data.labels[context.dataIndex];
                    },
                    font: {
                        weight: 'bold',
                        size: 14 // Adjust the size as needed
                    },
                    anchor: 'end',
                    align: 'end',
                    offset: 20
                }
            }
        },
        plugins: [ChartDataLabels]
    });
    document.getElementById('downloadResultsButton').style.display = 'block';
}

function getAverageScoresAndLabels() {
    var averageScores = [];
    var labels = [];
    document.querySelectorAll('#scoreSummary tbody tr').forEach(function(row) {
        if (row.style.display !== 'none') {
            var section = row.cells[0].textContent;
            var score = parseFloat(row.cells[1].textContent);
            labels.push(section);
            averageScores.push(score);
        }
    });
    return { labels, averageScores };
}

function determineBackgroundColor(score) {
    if (score <= 4) {
        return 'rgba(232, 99, 99, 0.6)'; // Red for low scores
    } else if (score <= 7) {
        return 'rgba(255, 206, 86, 0.6)'; // Amber for medium scores
    } else {
        return 'rgba(75, 192, 192, 0.6)'; // Green for high scores
    }
}

function downloadResultsWithCalculatedTable() {
    let organizationName = document.getElementById('organisationName').value.trim();
    let data = [['Organization Name', organizationName], ['', ''], ['Section', 'Question', 'Raw Score', 'Output Score']];
    document.querySelectorAll('.container select').forEach(function(select) {
        let sectionName = select.closest('.container').querySelector('h1').textContent.trim();
        let questionLabel = select.closest('div.question, div').querySelector('h4').textContent.trim();
        let rawScore = select.options[select.selectedIndex].text;
        let outputScore = select.closest('.container').querySelectorAll('.output-score span')[select.dataset.index]?.textContent.trim() || '';
        data.push([sectionName, questionLabel, rawScore, outputScore]);
    });
    data.push(['', '', '', '']);
    data.push(['Summary Section', 'Average Score']);
    document.querySelectorAll('#scoreSummary tbody tr').forEach(function(row) {
        let section = row.cells[0].textContent.trim();
        let averageScore = row.cells[1].textContent.trim();
        data.push([section, averageScore]);
    });
    let csvContent = data.map(row => row.map(field => `"${field.replace(/"/g, '""')}"`).join(",")).join("\n");
    let blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    let link = document.createElement("a");
    let url = URL.createObjectURL(blob);
    link.setAttribute("href", url);
    link.setAttribute("download", "Impact Diagnostic Assessment Scores.csv");
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}
</script>

</body>
</html>
