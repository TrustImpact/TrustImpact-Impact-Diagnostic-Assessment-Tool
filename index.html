<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Purpose Alignment Tool Score</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hansard Sentiment Analysis</title>
<link href="https://trst.uk/css/app.css" rel="stylesheet">
<!--<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet">-->
<!--<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;700&display=swap">-->
<script src="https://kit.fontawesome.com/19a0336ebe.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    body {
        font-family: 'Raleway', sans-serif;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        background-color: #ffffff;
    }
        .vc_custom_1707898486337 {
        background: rgba(242, 242, 242, 0.09) url(https://www.trustimpact.com/wp-content/uploads/2020/09/trust-impact-logo.png) 
    }

        .vc_custom_1707894194125 {
        margin-top: 80px !important;
    }
    #header {
        width: 100%;
        background-color: #FFFFFF; /* Adjust the background color as needed */
        padding: 10px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* Optional: adds a shadow for depth */
        text-align: center; /* Centers the logo horizontally */
    }
        #header img {
        height: 100px; 
    }

    div#form-container {
        background-color: #ffffff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
        border: 5px solid #f7d32e;
        max-width: 500px;  /* Adjust this value to your preference */
        width: 100%;
        margin: auto;  /* This will center the container */
    }
    h1 {
        color: #000000;
        margin-bottom: 20px;
    }
    h2 {
        color: #000000;
    }
    h3 {
        color: #000000;
    }
    h4 {
        color: #000000;
        font-weight: normal;
    }
    p {
    font-size: 60%; /* Relative to the font size of the element's parent */
    }
    select {
        padding: 10px;
        border-radius: 4px;
        border: 1px solid #ddd;
        margin-top: 10px;
    }
    button {
        background-color: #5D3FD3;
        color: #fff;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
        margin-top: 20px;
        font-weight: bold;
    }
    button:hover {
        background-color: #4c32cc;
    }
    #downloadResultsButton {
    display: none;
    }
    .containers-row {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-around; /* Or 'space-between' as per your design needs */
    align-items: flex-start;
    width: 100%;
    }
    .container {
    flex: 0 0 30%; /* Each box will take up roughly 30% of the container width */
    margin: 10px; /* Adjust as needed for spacing */
    }
    .output-score {
        display: none;
    }
    .container-score {
        margin-top: 10px;
        padding: 10px;
        background-color: #e9e9e9;
        border-radius: 4px;
        font-weight: bold;
    }
    select {
        width: 100%; /* Ensures that select occupies the full width of its parent container */
        height: 40px; /* Sets a fixed height for all select boxes */
        padding: 5px 10px; /* Adds some padding inside the select box for better text visibility */
        font-size: 16px; /* Adjusts the font size for the options */
        border: 1px solid #ddd; /* Adds a border to the select box */
        border-radius: 4px; /* Rounds the corners of the select box */
        box-sizing: border-box; /* Ensures padding does not affect the final calculated width */
        margin-top: 10px; /* Keeps the existing top margin for spacing */
        background-color: white; /* Optional: sets a background color */
        cursor: pointer; /* Changes cursor to pointer to indicate it's selectable */
    }

    /* You might want to add styles for focus and hover states for better user experience */
    select:hover {
        border-color: #aaa; /* Changes border color on hover */
    }

    select:focus {
        outline: none; /* Removes the default focus outline */
        border-color: #5D3FD3; /* Adds a custom border color on focus */
    }
</style>
</head>

    <div id="header">
        <img src="https://www.trustimpact.com/wp-content/uploads/2020/09/trust-impact-logo.png" alt="Trust Impact Logo" style="height: 100px;"> 
    </div>

<body>

<!--<div class="containers-row"> -->
<!-- Purpose Alignment Tool Score Container -->
<div id="PurposeAlignmentToolScore" class="container">
    <h1>Purpose Alignment Tool Score</h1>
    <h4>What was your team's alignment to purpose score?</h4>
    <br>

    <select id="alignmentScoreSelect" onchange="calculateScore('alignmentScoreSelect', 'outputPurposeAlignmentScore')">
        <option value="0">Please Select</option>
        <option value="0">0</option>
        <option value="1">1-10</option>
        <option value="2">11-20</option>
        <option value="3">21-30</option>
        <option value="4">31-40</option>
        <option value="5">41-50</option>
        <option value="6">51-60</option>
        <option value="7">61-70</option>
        <option value="8">71-80</option>
        <option value="9">81-90</option>
        <option value="10">91-100</option>
    </select>
    <div class="output-score">
        Purpose Alignment Score: <span id="outputPurposeAlignmentScore">0</span>
    </div>
</div>

<div class="containers-row">
<!-- Purpose Statement Assessment Container -->
<div id="PurposeStatementAssessmentScore" class="container">
    <h1>Purpose Statement Assessment</h1>
    
    <div class="question">
        <h4>To what extent is your purpose statement succinct?</h4>
        <p>(By succinct we anticipate this to be under 10 words and to the point)</p>
        <br>
        <select id="lengthScoreSelect" onchange="calculateScore('lengthScoreSelect', 'outputLengthScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
        </select>
        <div class="output-score">
            Length Score: <span id="outputLengthScore">0</span>
        </div>
    </div>


    <h4>How prevalent are common words such as support in your purpose statement?</h4>
    <br>
    <select id="commonwordsselect" onchange="calculateScore('commonwordsselect', 'outputcommonwordScore')">
            <option value="0">Please Select</option>
            <option value="10">0 - Not at all</option>
            <option value="9">1</option>
            <option value="8">2</option>
            <option value="7">3</option>
            <option value="6">4</option>
            <option value="5">5</option>
            <option value="4">6</option>
            <option value="3">7</option>
            <option value="2">8</option>
            <option value="1">9</option>
            <option value="0">10 - Extremely</option>
    </select>
    <div class="output-score">
        Common words Score: <span id="outputcommonwordScore">0</span> <!-- Default score -->
    </div>


    <h4>To what extent is do you feel your purpose statement is unique to your organisation?</h4>
    <br>
    <select id="uniqueselect" onchange="calculateScore('uniqueselect', 'outputuniqueScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        Uniqueness Score: <span id="outputuniqueScore">0</span> <!-- Default score -->
    </div>


    <h4>On a scale of 0 - 10, how clear is your purpose statement?</h4>
    <p>(i.e. free from jargon and easy to understand)</p>
    <br>
    <select id="jargonselect" onchange="calculateScore('jargonselect', 'outputjargonScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        Clarity Score: <span id="outputjargonScore">0</span> <!-- Default score -->
    </div>


    <h4>On a scale of 0 - 10, how focussed is your purpose statement?</h4>
    <p>(i.e. does it explicitly capture what you are trying to achieve as an organisation and the method for achieving this)</p>
    <br>
    <select id="focusselect" onchange="calculateScore('focusselect', 'outputfocusScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        Focus Score: <span id="outputfocusScore">0</span> <!-- Default score -->
    </div>
</div>


<!-- Impact Leadership Container -->
<div id="ImpactLeadershipScore" class="container">
    <h1>Impact Leadership Assessment</h1>
    <h4>On a scale of 0 - 10, to what extent would you agree that impact is led from the top of your organisation?</h4>
    <p>(i.e. do your senior leaders regularly discuss impact and take action to improve it?)</p>    
    <select id="impactledselect" onchange="calculateScore('impactledselect', 'outputledScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        Impact Led Score: <span id="outputledScore">0</span> <!-- Default score -->
    </div>

    <h4>To what extent do you agree that people in your organisation are excited about delivering social impact?</h4>
    <br>
    <select id="appetiteselect" onchange="calculateScore('appetiteselect', 'outputappetiteScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        Impact appetite Score: <span id="outputappetiteScore">0</span> <!-- Default score -->
    </div>

    
    <h4>To what extent would you agree impact work has been succesfully undertaken in the organisation?</h4>
    <br>
    <select id="desireselect" onchange="calculateScore('desireselect', 'outputdesireScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        Impact desire Score: <span id="outputdesireScore">0</span> <!-- Default score -->
    </div>


    <h4>To what extent do you feel the organisation is willing to undertake further work around impact?</h4>
    <br>
    <select id="cultureselect" onchange="calculateScore('cultureselect', 'outputcultureScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        Impact culture Score: <span id="outputcultureScore">0</span> <!-- Default score -->
    </div>


    <h4>To what extent would you agree that your organisation has a culture of understanding and measuring impact?</h4>
    <br>
    <select id="blockersselect" onchange="calculateScore('blockersselect', 'outputblockerscore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        Impact blocker Score: <span id="outputblockerscore">0</span> <!-- Default score -->
    </div>

    <h4>How easy would it be to achieve buy-in from key people in your organisation to improve your impact?</h4>
    <br>
    <select id="buyinselect" onchange="calculateScore('buyinelect', 'outputbuyinScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        Buy-in Score: <span id="outputbuyinScore">0</span> <!-- Default score -->
    </div>
</div>

<!-- Theory of Change Container -->
<div id="ToCScore" class="container">
    <h1>Theory of Change Assessment</h1>
    <h4>On a scale of 0 - 10 how complete do you believe your theory of change is?</h4>
    <p>(Does it include your resources, activities, outputs, outcomes, and impact?)</p>
    <br>
    <select id="TOCselect" onchange="calculateScore('TOCselect', 'outputTOCScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        ToC Score: <span id="outputTOCScore">0</span> <!-- Default score -->
    </div>

    <h4>To what extent is your theory of change used to drive the work of your organisation?</h4>
    <br>
    <select id="orgdriveselect" onchange="calculateScore('orgdriveselect', 'outputorgdriveScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        ToC use Score: <span id="outputorgdriveScore">0</span> <!-- Default score -->
    </div>

    
    <h4>To what extent do you think your organisation would be willing to revisit your theory of change?</h4>
    <br>
    <select id="upforchangeselect" onchange="calculateScore('upforchangeselect', 'outputupforchangeScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        Ameniability Score: <span id="outputupforchangeScore">0</span> <!-- Default score -->
    </div>


    <h4>To what extent do you agree that your theory of change is simple and straight forward?</h4>
    <p>Is it easily understood, non-confusing, one one page?</p>
    <select id="complexselect" onchange="calculateScore('complexselect', 'outputcomplexScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        ToC Complexity Score: <span id="outputcomplexScore">0</span> <!-- Default score -->
    </div>


    <h4>To what extent would you agree that the measures in your theory of change are measures of impact and not measures of reach?</h4>
    <br>
    <select id="correctlydefinedselect" onchange="calculateScore('correctlydefinedselect', 'outputcorrectlydefinedscore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        Definitions Score: <span id="outputcorrectlydefinedscore">0</span> <!-- Default score -->
    </div>
</div>


<div id="MWMScore" class="container">
    <h1>Measurement Framework Assessment</h1>
    <p>On a scale of 0-5, Is your framework feasable, cost effective, time efficient, resource appropriate and producing good quality, and reliable data?</p>
    <select id="MWMfeasibilityselect" onchange="calculateScore('MWMfeasibilityselect', 'outputMWMfeasibleScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        MWM feasibility Score: <span id="outputMWMfeasibleScore">0</span> <!-- Default score -->
    </div>

    
        <p>How many impact indicators are you measuring?</p>
    <select id="numberofindicatorsselect" onchange="calculateScore('numberofindicatorsselect', 'outputnumberofindicatorsScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        MWM count of indicators Score: <span id="outputnumberofindicatorsScore">0</span> <!-- Default score -->
    </div>


        <p>What percentage of these are outputs rather than outcomes?</p>
    <select id="percentageofindicatorsselect" onchange="calculateScore('percentageofindicatorsselect', 'outputpercentageofindicatorsScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        MWM percentage of indicators Score: <span id="outputpercentageofindicatorsScore">0</span> <!-- Default score -->
    </div>


        <p>Are your indicators based on validated data?</p>
    <select id="validatedindicatorsselect" onchange="calculateScore('validatedindicatorsselect', 'outputvalidatedindicatorsScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        MWM Validated indicators Score: <span id="outputvalidatedindicatorsScore">0</span> <!-- Default score -->
    </div>


        <p>Do your indicators have external data to which you can compare?</p>
    <select id="externalddataselect" onchange="calculateScore('externalddataselect', 'outputexternaldataScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        MWM indicators comparison Score: <span id="outputexternaldataScore">0</span> <!-- Default score -->
    </div>


        <p>Do you ask demographics questions to understand your reach?</p>
    <select id="reachdataselect" onchange="calculateScore('reachdataselect', 'outputreachdataScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        MWM demographics Score: <span id="outputreachdataScore">0</span> <!-- Default score -->
    </div>


        <p>Do your demographics help you examine your outcome data to better understand who you are maximising impact for?</p>
    <select id="segmentselect" onchange="calculateScore('segmentselect', 'outputsegmentScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        MWM Segmentation Score: <span id="outputsegmentScore">0</span> <!-- Default score -->
    </div>


        <p>Is your methodology for data analysis the best it could be</p>
    <select id="methodologyselect" onchange="calculateScore('methodologyselect', 'outputmethodologyScore')">
            <option value="0">Please Select</option>
            <option value="0">0 - Not at all</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10 - Extremely</option>
    </select>
    <div class="output-score">
        MWM collection methods Score: <span id="outputmethodologyScore">0</span> <!-- Default score -->
    </div>
</div>


<div id="DataScore" class="container">
    <h1>Data Assessment</h1>
    <p>Do you use defined and structured data fields rather than free text?</p>
    <select id="Datastructureselect" onchange="calculateScore('Datastructureselect', 'outputDataStructureScore')">
        <option value="0">All free text fields</option>
        <option value="1">Some structured fields but some unstructured</option>
        <option value="2">All appropriate fields defined and structured</option>
    </select>
    <div class="output-score">
        Data Structure Score: <span id="outputDataStructureScore">0</span> <!-- Default score -->
    </div>


    <p>Do you use unique identifiers to be able to look at the progress your participants make?</p>
    <select id="Datauniquedataselect" onchange="calculateScore('Datauniquedataselect', 'outputuniquedataScore')">
        <option value="0">No identifiers</option>
        <option value="1">No consistent identifiers used but possible to identify records using another field(s) (e.g. name and post code combo)</option>
        <option value="2">Unique identifiers used in some systems</option>
        <option value="3">System generated unique identifiers in all tables across database allowing for relationships between all relevant tables</option>
    </select>
    <div class="output-score">
        Data Uniqueness Score: <span id="outputuniquedataScore">0</span> <!-- Default score -->
    </div>


    <p>How "data savvy" are users?</p>
    <select id="Dataexpertiseselect" onchange="calculateScore('Dataexpertiseselect', 'outputexpertiseScore')">
        <option value="0">Minimal</option>
        <option value="1">Medium</option>
        <option value="2">High</option>
        <option value="3">Expert</option>
    </select>
    <div class="output-score">
        Data Savvy Score: <span id="outputexpertiseScore">0</span> <!-- Default score -->
    </div>


    <p>What is the level of completeness of your data?</p>
    <select id="Datacompletenessselect" onchange="calculateScore('Datacompletenessselect', 'outputcompletenessScore')">
        <option value="0">No useful data</option>
        <option value="1">Small number of records AND under 50% completeness</option>
        <option value="2">Large number of records with under 50% completeness OR small number of records with over 80% completeness</option>
        <option value="3">Up to 100% completeness</option>
    </select>
    <div class="output-score">
        Data Completeness Score: <span id="outputcompletenessScore">0</span> <!-- Default score -->
    </div>

    <p>Are your datapoints timestamped?</p>
    <select id="Datatimestampselect" onchange="calculateScore('Datatimestampselect', 'outputtimestampScore')">
        <option value="0">No way of determining when datapoints are logged or the date they refer to</option>
        <option value="1">There are some date fields that could be used to estimate timelines</option>
        <option value="2">Use of one or more date fields (can be system generated) to accurately indicate all relevant timepoints within the process (e.g. start, review, completion)</option>
    </select>
    <div class="output-score">
        Data timepoints Score: <span id="outputtimestampScore">0</span> <!-- Default score -->
    </div>


    <p>Is data structure and format consistent over time?</p>
    <select id="Dataconsistencyselect" onchange="calculateScore('Dataconsistencyselect', 'outputconsistencyScore')">
        <option value="0">Data structure regularly changes so no consistency over time</option>
        <option value="1">Some core fields remain pretty much constant whilst others may change</option>
        <option value="2">Data structure is formal and consistent with permanently defined fields. New fields may be added but not overwritten. Any updates to existing fields go through a formal process and data updated accordingly</option>
    </select>
    <div class="output-score">
        Data consistency Score: <span id="outputconsistencyScore">0</span> <!-- Default score -->
    </div>


    <p>Is data currently being effectively collected and reported on?</p>
    <select id="Dataeffectivenessselect" onchange="calculateScore('Dataeffectivenessselect', 'outputeffectivenessScore')">
        <option value="0">No formal quantitative reporting and no consistent data collection</option>
        <option value="1">Basic data collected manually, usually operational outputs. Reported either qualitatively or in basic Excel tables</option>
        <option value="2">Formal data collection to produce consistent data. Attempt to measure and report outcomes not just outputs. Reported in a consistent format either through structured Excel report or another reporting tool</option>
        <option value="3">Effective data collection with a range of consistent datapoint relating to outputs and outcomes. Data stored properly (database ideally) and pulled into clearly defined reporting in a data vis tool that is live, well maintained and provides deep insight</option>
    </select>
    <div class="output-score">
        Data effectiveness Score: <span id="outputeffectivenessScore">0</span> <!-- Default score -->
    </div>


    <p>Is data captured/input manually or automatically?</p>
    <select id="Dataautomaticityselect" onchange="calculateScore('Dataautomaticityselect', 'outputautomaticityScore')">
        <option value="0">Data captured manually either on paper, verbally by staff or purely in notes</option>
        <option value="1">Data input manually into a digital system by staff after relevant activity</option>
        <option value="2">Data flows from source to storage system automatically. Any input is digital first wherever possible and well streamlined</option>
    </select>
    <div class="output-score">
        Data automaticity Score: <span id="outputautomaticityScore">0</span> <!-- Default score -->
    </div>


    <p>Does the client capture demographic data effectively?</p>
    <select id="Datademographicsselect" onchange="calculateScore('Datademographicsselect', 'outputdatademographicsScore')">
        <option value="0">Little to no demographic data effectively collected</option>
        <option value="1">Core demographic data collected but not always aligned to ONS, may only exist in one system (CRM) and not possible to link to others, may be missing demographic details relevant to the specific use case</option>
        <option value="2">Range of demographic data collected as default for all relevant clients/beneficiaries, aligns to any external datasets needed, can be linked across datasets</option>
    </select>
    <div class="output-score">
        Data demographics Score: <span id="outputdatademographicsScore">0</span> <!-- Default score -->
    </div>
</div>


<div id="SystemScore" class="container">
    <h1>System Assessment</h1>
    <p>Is the number of systems being operated appropriate for the organisation?</p>
    <select id="numberofsystemsselect" onchange="calculateScore('numberofsystemsselect', 'outputnumberofsystemsScore')">
        <option value="0">No formal system in place. Reliance on basic tools and Excel</option>
        <option value="1">One or two core systems being used. Still some reliance on other basic tools to fill in gaps</option>
        <option value="2">Suitable number of systems for the work being done with appropriate infrastructure in place to manage and maintain them</option>
    </select>
    <div class="output-score">
        System appropriateness Score: <span id="outputnumberofsystemsScore">0</span> <!-- Default score -->
    </div>


    <p>Are the systems modern and fit for purpose?</p>
    <select id="systemfitnessselect" onchange="calculateScore('systemfitnessselect', 'outputsystemfitnessScore')">
        <option value="0">No formal system(s) in place and dependence on basic tools to fill gaps (Excel etc)</option>
        <option value="1">One or two modern systems that can be effective but not used effectively / being used for too much. Use of legacy systems that are difficult to use/maintain and lack modern functionality</option>
        <option value="2">Systems in use are appropriate for their requirements, should not need replacing in next 2 years. Likely industry standard tools or well reasoned alternatives and likely Cloud based</option>
    </select>
    <div class="output-score">
        System fitness Score: <span id="outputsystemfitnessScore">0</span> <!-- Default score -->
    </div>


    <p>Does the organisation have the appropriate personnel and support in place to run their systems?</p>
    <select id="systempersonnelselect" onchange="calculateScore('systempersonnelselect', 'outputsystempersonnelScore')">
        <option value="0">No IT or data specific roles exist</option>
        <option value="1">Some IT and data responsibilities in place but generally built in to broader roles. May be owned by someone without the right skillset</option>
        <option value="2">Some dedicated IT and/or data roles with reasonable skillset and control of systems</option>
        <option value="3">Appropriate number of experts in place dedicated to maintanence of relevant systems and data</option>
    </select>
    <div class="output-score">
        System Personnel Score: <span id="outputsystempersonnelScore">0</span> <!-- Default score -->
    </div>


    <p>Is it possible for the client to customise impact relevant systems or does this require support?</p>
    <select id="systempcustomisationselect" onchange="calculateScore('systempcustomisationselect', 'outputsystemcustomisationScore')">
        <option value="0">Very little customisation possible at all</option>
        <option value="1">Customisation possible but requires long lead times and can be costly</option>
        <option value="2">Systems owned by client and their IT team able to effectively customise where required</option>
    </select>
    <div class="output-score">
        System Customisation Score: <span id="outputsystemcustomisationScore">0</span> <!-- Default score -->
    </div>


    <p>Do systems talk to each other and/or is there a central data warehouse?</p>
    <select id="systemconnectivityselect" onchange="calculateScore('systemconnectivityselect', 'outputsystemconnectivityScore')">
        <option value="0">Siloed systems, may lack any identifiers, APIs or ways of interacting</option>
        <option value="1">Some possibility for basic system "integration". Often requires some effort like exporting datasets and joining them in Excel, importing data from one system to another manually etc</option>
        <option value="2">Automated integration between systems. May include a data warehouse if needed or could be a central system (e.g. Salesforce) that pulls data from other systems itself</option>
    </select>
    <div class="output-score">
        System Connectivity Score: <span id="outputsystemconnectivityScore">0</span> <!-- Default score -->
    </div>


    <p>How long has the client been using/operating their systems? (speaks to both experience and history)</p>
    <select id="systemageselect" onchange="calculateScore('systemageselect', 'outputsystemageScore')">
        <option value="0">In process of selecting or moving on to new system(s)</option>
        <option value="1">Recently moved onto new system(s)</option>
        <option value="2">System(s) have been operational for a reasonable length of time and are BAU and have history</option>
    </select>
    <div class="output-score">
        System Age Score: <span id="outputsystemageScore">0</span> <!-- Default score -->
    </div>
</div>

    
<!-- Score Summary Table -->
<div id="scoreSummary">
    <h1>Score Summary</h1>
    <table class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>Section</th>
                <th>Average Score</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Purpose Alignment Tool Score</td>
                <td id="totalPurposeAlignmentToolScore">0</td>
            </tr>
            <tr>
                <td>Purpose Statement Assessment Score</td>
                <td id="totalPurposeStatementAssessmentScore">0</td>
            </tr>
            <tr>
                <td>Impact Leadership Score</td>
                <td id="totalImpactLeadershipScore">0</td>
            </tr>
            <tr>
                <td>Theory of Change Score</td>
                <td id="totalToCScore">0</td>
            </tr>
            <tr>
                <td>Measurement Framework Score</td>
                <td id="totalMWMScore">0</td>
            </tr>
            <tr>
                <td>Data Review Score</td>
                <td id="totalDataScore">0</td>
            </tr>
            <tr>
                <td>System Review Score</td>
                <td id="totalSystemScore">0</td>
            </tr>
        </tbody>
    </table>
</div>
</div>


    <!-- The button to generate the radar chart should probably be here -->
    <button onclick="generateRadarChart()">Generate Radar Chart</button>
    <button id="downloadResultsButton" onclick="downloadResultsWithCalculatedTable()">Download Complete Results</button>



</div>

<!-- Radar Chart Container -->
<div>
    <canvas id="myRadarChart" width="800" height="800"></canvas>
</div>


<script>


// Function to calculate and display score based on the selected option
function calculateScore(selectId, outputId) {
    var selectElement = document.getElementById(selectId);
    var score = parseInt(selectElement.value, 10);
    document.getElementById(outputId).textContent = score; // Update the hidden span with the score

    // Call updateScoreTable here with the container ID and the new score
    var containerId = selectElement.closest('.container').id;
    updateScoreTable(containerId);
}

// Function to update the score table with new values
function updateScoreTable(containerId) {
    var container = document.getElementById(containerId);
    var selects = container.querySelectorAll('select');
    
    // Check if there are select elements to avoid division by zero
    if (selects.length === 0) return;

    var totalScore = 0;
    selects.forEach(function(select) {
        totalScore += parseInt(select.value, 10);
    });

    // Calculate the average score
    var averageScore = totalScore / selects.length;

    // Round the average score to a desired number of decimal places, e.g., 2
    averageScore = averageScore.toFixed(2);

    var scoreCellId = 'total' + containerId;
    var scoreCell = document.getElementById(scoreCellId);
    if (scoreCell) {
        scoreCell.textContent = averageScore;
    }
}

// Initialize the score table with the default scores
function initializeScoreTable() {
    var containerDivs = document.querySelectorAll('.container');
    containerDivs.forEach(function(container) {
        updateScoreTable(container.id);
    });
}

// Call this function once to initialize the table at script load
initializeScoreTable();

function getAverageScores() {
    var averageScores = [];
    var scoreCells = document.querySelectorAll('#scoreSummary tbody td:nth-child(2)'); // Selects every second cell in each row of the tbody

    scoreCells.forEach(function(cell) {
        averageScores.push(parseFloat(cell.textContent)); // Convert the text content to a float and add to the array
    });

    return averageScores;
}

function generateRadarChart() {
    var ctx = document.getElementById('myRadarChart').getContext('2d');
    var averageScores = getAverageScores() // Get the average scores

    var chart = new Chart(ctx, {
        type: 'radar',
        data: {
            labels: ['Purpose Alignment', 'Purpose Statement', 'Impact Leadership', 'Theory of Change', 'Measurement Framework', 'Data Review', 'System Review'], // Adjust these labels as per your containers
            datasets: [{
                label: 'Average Scores',
                data: averageScores,
                backgroundColor: 'rgba(93, 63, 211, 0.2)', // Example color, adjust as needed
                borderColor: 'rgba(93, 63, 211, 1)', // Example color, adjust as needed
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                r: {
                    angleLines: {
                        display: true
                    },
                    suggestedMin: 0, // Suggests the minimum value for the scale
                    suggestedMax: 10, // Suggests the maximum value for the scaleoptions: {
                    ticks: {
                        beginAtZero: true,
                        max: 10, // Assuming the maximum average score is 10
                        min: 0,
                        stepSize: 0.5
                    }
                }
            }
        }
    });
    document.getElementById('downloadResultsButton').style.display = 'block'; // Or 'inline-block'
}

function downloadResultsWithCalculatedTable() {
    // Initialize CSV data array with header
    let data = [['Section', 'Question', 'Raw Score', 'Output Score']];

    // Iterate over each container to collect scores and outputs
    document.querySelectorAll('.container').forEach(function(container) {
        let sectionName = container.querySelector('h1').textContent.trim();

        // Collect data from each question within the section
        container.querySelectorAll('select').forEach(function(select, index) {
            let questionLabel = select.closest('div.question, div').querySelector('h4, p').textContent.trim();
            let rawScore = select.options[select.selectedIndex].text;
            let outputScore = container.querySelectorAll('.output-score span')[index]?.textContent.trim() || ''; // Adjust if necessary

            // Add row for each question
            data.push([sectionName, questionLabel, rawScore, outputScore]);
        });
    });

    // Add a separator row before the summary
    data.push(['', '', '', '']);
    data.push(['Summary Section', 'Average Score']);

    // Add the calculated table data
    document.querySelectorAll('#scoreSummary tbody tr').forEach(function(row) {
        let section = row.cells[0].textContent.trim();
        let averageScore = row.cells[1].textContent.trim();

        data.push([section, averageScore]);
    });

    // Format data as CSV
    let csvContent = data.map(e => e.join(",")).join("\n");

    // Trigger download
    let blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    let link = document.createElement("a");
    let url = URL.createObjectURL(blob);
    link.setAttribute("href", url);
    link.setAttribute("download", "complete-analysis-results.csv");
    document.body.appendChild(link); // Required for FF
    link.click();
    document.body.removeChild(link); // Clean up
}


</script>

</body>
</html>
